<?xml version="1.0" ?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro">
  <xacro:property name="joint_effort" value="10.0" />
  <xacro:property name="joint_velocity" value="1.0" />
  <xacro:property name="joint_damping" value="0.1" />
  <xacro:property name="joint_friction" value="0.1" />
  
  <xacro:property name="worm_joint_effort" value="20.0" />
  <xacro:property name="worm_joint_velocity" value="2.0" />

  <xacro:macro name="gripper_link_inertial" params="mass">
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <mass value="${mass}" />
      <inertia ixx="1e-6" ixy="0.0" ixz="0.0" iyy="1e-6" iyz="0.0" izz="1e-6" />
    </inertial>
  </xacro:macro>

  <material name="walkie_aluminum_polished">
    <color rgba="0.95686 0.96078 0.96471 1.0" />
  </material>
  <material name="walkie_opaque_gold">
    <color rgba="0.83137 0.66667 0.12941 1.0" />
  </material>

  <xacro:macro name="walkie_gripper" params="parent prefix">
    
    <joint name="${prefix}_joint7" type="revolute">
      <axis xyz="0.0 0.0 -1.0" />
      <limit effort="30.0" lower="-3.14" upper="3.14" velocity="2.0" />
      <parent link="${parent}" /> <child link="${prefix}_link7" />
      <origin xyz="0.0 0.02800 -0.13825" rpy="0.0 0.0 0.0" />
      <dynamics damping="${joint_damping}" friction="${joint_friction}" />
    </joint>

    <link name="${prefix}_link7">
      <visual>
        <material name="walkie_opaque_gold" />
        <origin rpy="0.0 0.0 0.0" xyz="0.0 0.02116 -0.03906" />
        <geometry>
          <mesh filename="package://arm_description/meshes/walkie-gripper/stl/Body1.121.stl" scale="1 1 1"/>
        </geometry>
      </visual>
      <collision>
        <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 -0.03004"/>
        <geometry>
          <box size="0.12520 0.05916 0.05330"/>
        </geometry>
      </collision>
      <xacro:gripper_link_inertial mass="0.2" />
    </link>

    <link name="${prefix}_gripper_worm_gear">
      <xacro:gripper_link_inertial mass="0.02" />
      <visual>
        <material name="walkie_aluminum_polished" />
        <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 0.0" />
        <geometry>
          <mesh filename="package://arm_description/meshes/walkie-gripper/stl/Body1.133.stl" scale="1 1 1"/>
        </geometry>
      </visual>
    </link>

    <joint name="${prefix}_gripper_worm_gear" type="revolute">
      <limit lower="-15.7" upper="3.14" effort="${worm_joint_effort}" velocity="${worm_joint_velocity}"/>
      <origin rpy="0.0 0.0 0.0" xyz="0.0 0.0 -0.00275"/>
      <parent link="${prefix}_link7"/>
      <child link="${prefix}_gripper_worm_gear"/>
      <axis xyz="0.0 0.0 -1.0"/>
      <dynamics damping="${joint_damping}" friction="${joint_friction}" />
    </joint>

    <link name="${prefix}_gripper_gear_r">
      <xacro:gripper_link_inertial mass="0.01" />
      <visual>
        <material name="walkie_aluminum_polished" />
        <geometry>
          <mesh filename="package://arm_description/meshes/walkie-gripper/stl/Body1.113.stl" scale="1 1 1"/>
        </geometry>
      </visual>
    </link>

    <joint name="${prefix}_gripper_gear_r" type="revolute">
      <limit lower="-3.14" upper="3.14" effort="${joint_effort}" velocity="${joint_velocity}"/>
      <mimic multiplier="0.1" offset="0" joint="${prefix}_gripper_worm_gear"/>
      <origin rpy="0.0 0.0 0.0" xyz="-0.03240 -0.00100 -0.05335"/>
      <parent link="${prefix}_link7"/>
      <child link="${prefix}_gripper_gear_r"/>
      <axis xyz="0.0 -1.0 0.0"/>
      <dynamics damping="${joint_damping}" friction="${joint_friction}" />
    </joint>

    <link name="${prefix}_gripper_gear_l">
      <xacro:gripper_link_inertial mass="0.01" />
      <visual>
        <material name="walkie_aluminum_polished" />
        <geometry>
          <mesh filename="package://arm_description/meshes/walkie-gripper/stl/Body1.007.stl" scale="1 1 1"/>
        </geometry>
      </visual>
    </link>

    <joint name="${prefix}_gripper_gear_l" type="revolute">
      <limit lower="-3.14" upper="3.14" effort="${joint_effort}" velocity="${joint_velocity}"/>
      <mimic multiplier="-0.1" offset="0" joint="${prefix}_gripper_worm_gear"/>
      <origin rpy="0.0 0.0 0.0" xyz="0.03240 -0.00100 -0.05335"/>
      <parent link="${prefix}_link7"/>
      <child link="${prefix}_gripper_gear_l"/>
      <axis xyz="0.0 -1.0 0.0"/>
      <dynamics damping="${joint_damping}" friction="${joint_friction}" />
    </joint>

    <link name="${prefix}_gripper_hand_r">
      <xacro:gripper_link_inertial mass="0.015" />
      <collision>
        <origin rpy="0.0 0.0 0.0" xyz="-0.00904 0.0 -0.04823"/>
        <geometry>
          <box size="0.03010 0.01000 0.16753"/>
        </geometry>
      </collision>
      <visual>
        <material name="walkie_opaque_gold" />
        <geometry>
          <mesh filename="package://arm_description/meshes/walkie-gripper/stl/Body1.123.stl" scale="1 1 1"/>
        </geometry>
      </visual>
    </link>

    <joint name="${prefix}_gripper_hand_r" type="revolute">
      <limit lower="-3.14" upper="3.14" effort="${joint_effort}" velocity="${joint_velocity}"/>
      <mimic multiplier="-1.0" offset="0" joint="${prefix}_gripper_gear_r"/>
      <origin rpy="0.0 0.0 0.0" xyz="0.00896 0.00100 -0.06579"/>
      <parent link="${prefix}_gripper_gear_r"/>
      <child link="${prefix}_gripper_hand_r"/>
      <axis xyz="0.0 -1.0 0.0"/>
      <dynamics damping="${joint_damping}" friction="${joint_friction}" />
    </joint>

    <link name="${prefix}_gripper_hand_l">
      <xacro:gripper_link_inertial mass="0.015" />
      <collision>
        <origin rpy="0.0 0.0 0.0" xyz="0.00904 0.0 -0.04823"/>
        <geometry>
          <box size="0.03010 0.01000 0.16753"/>
        </geometry>
      </collision>
      <visual>
        <material name="walkie_opaque_gold" />
        <geometry>
          <mesh filename="package://arm_description/meshes/walkie-gripper/stl/Body1.046.stl" scale="1 1 1"/>
        </geometry>
      </visual>
    </link>

    <joint name="${prefix}_gripper_hand_l" type="revolute">
      <limit lower="-3.14" upper="3.14" effort="${joint_effort}" velocity="${joint_velocity}"/>
      <mimic multiplier="-1.0" offset="0" joint="${prefix}_gripper_gear_l"/>
      <origin rpy="0.0 0.0 0.0" xyz="-0.00896 0.00100 -0.06579"/>
      <parent link="${prefix}_gripper_gear_l"/>
      <child link="${prefix}_gripper_hand_l"/>
      <axis xyz="0.0 -1.0 0.0"/>
      <dynamics damping="${joint_damping}" friction="${joint_friction}" />
    </joint>

    <link name="${prefix}_gripper_connector_r">
      <xacro:gripper_link_inertial mass="0.01" />
      <visual>
        <material name="walkie_aluminum_polished" />
        <geometry>
          <mesh filename="package://arm_description/meshes/walkie-gripper/stl/Body1.019.stl" scale="1 1 1"/>
        </geometry>
      </visual>
    </link>

    <joint name="${prefix}_gripper_connector_r" type="revolute">
      <limit lower="-3.14" upper="3.14" effort="${joint_effort}" velocity="${joint_velocity}"/>
      <mimic multiplier="-1.0" offset="0" joint="${prefix}_gripper_hand_r"/>
      <origin rpy="0.0 0.0 0.0" xyz="-0.01742 0.0 0.02955"/>
      <parent link="${prefix}_gripper_hand_r"/>
      <child link="${prefix}_gripper_connector_r"/>
      <axis xyz="0.0 -1.0 0.0"/>
      <dynamics damping="${joint_damping}" friction="${joint_friction}" />
    </joint>

    <link name="${prefix}_gripper_connector_l">
      <xacro:gripper_link_inertial mass="0.01" />
      <visual>
        <material name="walkie_aluminum_polished" />
        <geometry>
          <mesh filename="package://arm_description/meshes/walkie-gripper/stl/Body1.003.stl" scale="1 1 1"/>
        </geometry>
      </visual>
    </link>

    <joint name="${prefix}_gripper_connector_l" type="revolute">
      <limit lower="-3.14" upper="3.14" effort="${joint_effort}" velocity="${joint_velocity}"/>
      <mimic multiplier="-1.0" offset="0" joint="${prefix}_gripper_hand_l"/>
      <origin rpy="0.0 0.0 0.0" xyz="0.01742 0.0 0.02955"/>
      <parent link="${prefix}_gripper_hand_l"/>
      <child link="${prefix}_gripper_connector_l"/>
      <axis xyz="0.0 -1.0 0.0"/>
      <dynamics damping="${joint_damping}" friction="${joint_friction}" />
    </joint>

  </xacro:macro>
</robot>